<!DOCTYPE html>
<html>
<head>
  <title>Uganda Business AI</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>

<body style="margin:0; font-family:Arial; display:flex; height:100vh;">

<!-- Sidebar -->
<div style="width:220px; background:#1e3a8a; color:white; padding:20px;">
  <h3>ðŸ‡ºðŸ‡¬ Uganda AI</h3>
  <p style="font-size:14px;">Business Assistant</p>
  <hr style="border:0; border-top:1px solid rgba(255,255,255,0.3);">

  <p>Free Uses:</p>
  <h2 id="usageLeft">5</h2>

  <button onclick="logout()"
  style="margin-top:20px; padding:8px; width:100%; border:none; border-radius:5px;">
  Logout
  </button>
</div>

<!-- Main Content -->
<div style="flex:1; padding:30px; background:#f4f6f9;">

  <h2>Business AI Generator</h2>

  <textarea id="prompt"
  placeholder="Ask: Give me a business idea in Kampala"
  style="width:100%; height:100px; padding:10px; margin-top:10px;"></textarea>

  <br><br>

  <button onclick="generate()"
  style="background:green; color:white; padding:10px 20px; border:none; border-radius:6px;">
  Generate
  </button>

  <div id="output"
  style="margin-top:20px; background:white; padding:20px; border-radius:8px; min-height:100px;">
  </div>

</div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore-compat.js"></script>

<script>

const firebaseConfig = {
  apiKey: "AIzaSyBCT-4-aSVz6ecsSYEViz0x3TLIblclID0",
  authDomain: "uganda-business-ai.firebaseapp.com",
  projectId: "uganda-business-ai",
  storageBucket: "uganda-business-ai.firebasestorage.app",
  messagingSenderId: "31664510646",
  appId: "1:31664510646:web:672abe804ec43cf65c7817"
};

firebase.initializeApp(firebaseConfig);

const auth = firebase.auth();
const db = firebase.firestore();

auth.onAuthStateChanged(user => {
  if (!user) {
    window.location.href = "login.html";
  }
});

function logout() {
  auth.signOut().then(() => {
    window.location.href = "login.html";
  });
}

function generate() {

  let usage = localStorage.getItem("usageCount") || 0;
  usage = parseInt(usage);

  if (usage >= 5) {
    document.getElementById("output").innerText =
      "ðŸš« Free limit reached. Upgrade to Pro for unlimited access.";
    return;
  }

  usage++;
  localStorage.setItem("usageCount", usage);
  document.getElementById("usageLeft").innerText = 5 - usage;

  let input = document.getElementById("prompt").value.toLowerCase();
  let response = "";

  if (input.includes("business idea")) {
    response =
      "ðŸ“Œ Business Idea: Poultry Farming in Kampala\n\n" +
      "ðŸ’° Startup Cost: UGX 2M â€“ 5M\n\n" +
      "ðŸ“Š Market Opportunity:\nHigh demand for eggs and chicken in urban areas.\n\n" +
      "ðŸ“ˆ Revenue Model:\nSell to restaurants, supermarkets, and local markets.\n\n" +
      "ðŸš€ Growth Strategy:\nStart small (100 birds), reinvest profits, scale gradually.";
  }

  else if (input.includes("business plan")) {
    response =
      "ðŸ“‹ Business Plan Outline:\n\n" +
      "1ï¸âƒ£ Executive Summary\nDescribe your business and vision.\n\n" +
      "2ï¸âƒ£ Market Analysis\nIdentify target customers in Uganda.\n\n" +
      "3ï¸âƒ£ Operations Plan\nLocation, suppliers, staff needs.\n\n" +
      "4ï¸âƒ£ Financial Plan\nStartup costs, pricing, expected profit.\n\n" +
      "5ï¸âƒ£ Marketing Strategy\nSocial media + WhatsApp marketing.";
  }

  else if (input.includes("market analysis")) {
    response =
      "ðŸ“Š Market Analysis (Uganda):\n\n" +
      "ðŸŽ¯ Target Market:\nUrban youth & SMEs.\n\n" +
      "ðŸ“ˆ Demand Level:\nGrowing due to rising entrepreneurship.\n\n" +
      "âš  Competition:\nModerate â€“ differentiation required.\n\n" +
      "ðŸ’¡ Opportunity:\nDigital-first businesses are expanding rapidly.";
  }

  else {
    response =
      "ðŸ§  Uganda Business AI Suggestion:\n\n" +
      "Focus on solving a real problem in your community.\n\n" +
      "Start small, validate demand, then scale.\n\n" +
      "Ask more specific questions like:\n" +
      "- Give me a business idea in Kampala\n" +
      "- Create a business plan for poultry farming\n" +
      "- Provide market analysis for cosmetics business";
  }

  document.getElementById("output").innerText = response;

  const user = auth.currentUser;
  if (user) {
    db.collection("users").doc(user.uid).collection("prompts").add({
      text: input,
      createdAt: new Date()
    });
  }
}

  let usage = localStorage.getItem("usageCount") || 0;
  usage = parseInt(usage);

  if (usage >= 5) {
    document.getElementById("output").innerText =
      "ðŸš« Free limit reached.";
    return;
  }

  usage++;
  localStorage.setItem("usageCount", usage);

  document.getElementById("usageLeft").innerText = 5 - usage;

  let input = document.getElementById("prompt").value.toLowerCase();
  let response = "";

  if (input.includes("business idea")) {
    response = "Start a poultry farming business in Kampala. High demand, low capital.";
  } else if (input.includes("marketing")) {
    response = "Use WhatsApp marketing, Facebook ads, and referrals.";
  } else {
    response = "Focus on solving real problems in Uganda and start small.";
  }

  document.getElementById("output").innerText = response;

  const user = auth.currentUser;
  if (user) {
    db.collection("users").doc(user.uid).collection("prompts").add({
      text: input,
      createdAt: new Date()
    });
  }
}

</script>

</body>
</html>
